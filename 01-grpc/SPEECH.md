Hi, my name is Alex Pliutau, and this is "package name".

<INTRO MUSIC>

It's a very first video in this channel, so I am very excited. Before we're going to the topic of this video, I want to make a short introduction about myself. I write mostly Go these days. And I like to share what Iâ€™m doing. So this channel will be about it.

I am working as tech lead at Wizeline Vietnam based in Ho Chi Minh City.

So one day I asked people on dev.to what do they want to watch about programming in Go, and I found that people are interested in code reviews, new packages and building tools.

Makes sense? Let's start.

In today video I want to show how to build gRPC server and client in Go, how to compile Go bindings from ProtoBuf definition. Our server will be a fictional blockchain system. Don't worry if you don't know what is it, it's very simple and we will focus on different things.

I'll create a folder for our project: `cd ~/go/src/github.com/plutov && mkdir blockchain`. And open it in VSCode - `code blockchain/`.

So, how do we start? I think it's a good way to start with a definition of our service, what functions and types will be exposed to client. How it works in gRPC using ProtoBuf: we create a definition first, and then server and clients generate language bindings from this definition.

We will use proto3 ProtoBuf language, it's very easy. Let's create a `proto` folder for this. We create a folder because later we will have a package there, so we want it to be in specific place and don't mess with other packages.

`proto/blockchain.proto`.

We need to set a package name, so later when we'll generate bindings from this file it will have this name. Let's have `proto` package as it has same name as a folder. Then we define 2 RPC endpoints: AddBlock to add block to the blockchain, and GetBlockchain to get the full list of blocks. Now we need to define what types we expect: request, response, block.

So, how we can use this file in Go? We will use a `protoc` command line tool to create a Go bindings.
We need to install compiler https://github.com/google/protobuf/releases.
And also we need to install Go plugin for protoc:
```
go get -u github.com/golang/protobuf/protoc-gen-go
```

Let's build Go bindings:
```
protoc --go_out=plugins=grpc:. proto/blockchain.proto
```

It will create `proto/blockchain.pb.go` file. Let's open this file and see what it has. We have our exported types, and we have interfaces for Server and Client, it means that this file can be used by Server but also by Client in case our Server and Client written in the same language, like we have now.

Now we will need to create a simple server and implement `BlockchainServer` interface.

Create `server/main.go`. Before going to code we will need to install some Go dependencies:
```
go get -u google.golang.org/grpc
go get -u golang.org/x/net/context (As you may know Go already has context package in stdlib, but code generated by protoc uses context package from golang.org/x/net)
go get -u github.com/golang/protobuf/proto
```

We will make our server running on port 8080. And now we will use our bindings to register grpc server and pass the implementation. We won't implement endpoints yet, we just implement the interface first and see if it compiles.

```
go run server/main.go
```

`server/blockchain/blockchain.go`:

Ok, now let's do some blockchain, the blockchain itself is very simple, each block has a hash generated from data and previous block hash. So if someone changes data in any block, next block can easily verify that data is changed, because hash will be different. There is also a Genesis block, like a root one. I am not going into details, but there are few exported functions: NewBlockchain - server will call it on start, it will also create Genesis block. We also have `AddBlock` and `GetBlockchain` methods we will use in our gRPC endpoints.

Let's import this package and use it in a server, let's compile to see if it still works.

Now our simple server is ready, to test it we will create gRPC client.

`client/main.go`:
The client will be a simple command line tool to add block to the blockchain or get information about the blockchain. I will handle it by using `flag` package, --add flag will add a block, --list will get a list of blocks.

We will also import `proto` package and create a client NewBlockchainClient using connection to port 8080. And then we just use client's functions and print results.

We use `grpc.WithInsecure` option, but there are a lot more: timeout options, ssl options.

I hope it was interesting and helpful. Send me your feedback if you have, and see you later!